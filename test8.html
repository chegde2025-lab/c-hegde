<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Great American Insurance Set - Detailed Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f4f6f9;
            line-height: 1.6;
        }
        h1, h2, h3 {
            color: #1f4e79;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0px 4px 15px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
        }
        .highlight {
            background-color: #eef5ff;
            padding: 12px;
            border-left: 5px solid #1f4e79;
        }
        pre {
            background-color: #272822;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th {
            background-color: #1f4e79;
            color: white;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        ul {
            margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="container">

<h1>Great American Insurance Set (With Calculation Details)</h1>

<div class="section">
<h2>1. Overview</h2>
<div class="highlight">
The Great American Insurance Set is an outbound integration package 
that aggregates claim financial data and sends structured information 
to the external Great American Insurance system.
</div>
</div>

<div class="section">
<h2>2. Source Tables</h2>
<ul>
    <li>claim</li>
    <li>policy</li>
    <li>exposure</li>
    <li>transaction</li>
    <li>reserve</li>
    <li>payment</li>
</ul>
</div>

<div class="section">
<h2>3. Core Financial Calculations</h2>

<h3>Total Reserve</h3>
<pre>
SELECT SUM(amount)
FROM reserve
WHERE claim_id = :claimId
AND status = 'OPEN';
</pre>

Formula:
<pre>
Total Reserve = Sum(Open Reserve Amounts)
</pre>

<h3>Total Paid</h3>
<pre>
SELECT SUM(amount)
FROM payment
WHERE claim_id = :claimId
AND status = 'ISSUED';
</pre>

Formula:
<pre>
Total Paid = Sum(Issued Payments)
</pre>

<h3>Outstanding Amount</h3>
<pre>
Outstanding = Total Reserve - Total Paid
</pre>

<h3>Net Incurred</h3>
<pre>
Net Incurred = Total Paid + Outstanding
</pre>

</div>

<div class="section">
<h2>4. Exposure-Level Calculation</h2>

<pre>
SELECT e.exposure_id,
       SUM(r.amount) AS reserve_amount,
       SUM(p.amount) AS paid_amount
FROM exposure e
LEFT JOIN reserve r ON e.exposure_id = r.exposure_id
LEFT JOIN payment p ON e.exposure_id = p.exposure_id
WHERE e.claim_id = :claimId
GROUP BY e.exposure_id;
</pre>

</div>

<div class="section">
<h2>5. Multi-Currency Conversion (If Applicable)</h2>

Formula:
<pre>
Base Currency Amount = Transaction Amount × Exchange Rate
</pre>

Example:
<pre>
USD 1000 × 83 = INR 83,000
</pre>

</div>

<div class="section">
<h2>6. Validation Checks</h2>

<ul>
    <li>Header Total Reserve = Sum of Detail Reserve</li>
    <li>Header Total Paid = Sum of Detail Paid</li>
    <li>Total Paid ≤ Policy Limit</li>
    <li>Debit = Credit (if accounting involved)</li>
</ul>

</div>

<div class="section">
<h2>7. Database Design</h2>

<h3>Header Table</h3>
<pre>
CREATE TABLE great_american_set (
    gai_ext_set_id     NUMBER PRIMARY KEY,
    claim_id           NUMBER,
    event_type         VARCHAR2(50),
    total_reserve      NUMBER(18,2),
    total_paid         NUMBER(18,2),
    outstanding        NUMBER(18,2),
    currency           VARCHAR2(10),
    status             VARCHAR2(20),
    created_date       DATE DEFAULT SYSDATE
);
</pre>

<h3>Detail Table</h3>
<pre>
CREATE TABLE great_american_set_detail (
    gai_ext_detail_id  NUMBER PRIMARY KEY,
    gai_ext_set_id     NUMBER,
    exposure_id        NUMBER,
    reserve_amount     NUMBER(18,2),
    paid_amount        NUMBER(18,2),
    FOREIGN KEY (gai_ext_set_id)
        REFERENCES great_american_set(gai_ext_set_id)
);
</pre>

</div>

<div class="section">
<h2>8. Example Financial Summary</h2>

<table>
<tr>
    <th>Exposure</th>
    <th>Reserve</th>
    <th>Paid</th>
</tr>
<tr>
    <td>Vehicle Damage</td>
    <td>50,000</td>
    <td>30,000</td>
</tr>
<tr>
    <td>Bodily Injury</td>
    <td>40,000</td>
    <td>20,000</td>
</tr>
<tr>
    <th>Total</th>
    <th>90,000</th>
    <th>50,000</th>
</tr>
</table>

Outstanding:
<pre>
90,000 - 50,000 = 40,000
</pre>

</div>

<div class="section">
<h2>9. Integration Flow</h2>

<pre>
Claim / Reserve / Payment Updated
        ↓
Calculate Totals
        ↓
Validate Financial Consistency
        ↓
Create Header Record
        ↓
Insert Exposure-Level Details
        ↓
Generate JSON/XML Payload
        ↓
Send to External System
        ↓
Mark as SENT
</pre>

</div>

<div class="section">
<h2>10. Final Definition</h2>
<div class="highlight">
The Great American Insurance Set is a calculated financial integration package 
that aggregates reserve and payment data, validates totals, and transmits 
structured claim information to an external insurance system.
</div>
</div>

</div>

</body>
</html>
